# 软件交付

软件交付的核心策略及金句

- 细粒度、低耦合，自己完成一件事情，不要总是动辄牵扯到别的人、别的事，这是软件交付的首要策略。
- 在各个方面追求小批量：小批量的设计功能、交代开发任务，小批量的集成，小批量的测试，小批量的发布。于是，就有可能让整个流程持续的流动起来，而不是走走停停。（批量越大风险越大越不可控，但批量也不宜过小，太小让事情变得更麻烦难以管理，最好是逻辑上完整的小批量）。
- 自动化工具要好用。其中比较重要的一点是，用户可以方便地自行配置使用，也就是自助化。
- 适当交叠有益，过分交叠有害。
- 每次代码改动提交，都应该是逻辑上完整的完成了一小块改动。
- 经典的持续集成方式是：开发人员可以随时香集成分支提交代码改动，而每次提交代码改动时都会出发一系列轻量级的自动化测试。
- 作为一个硬指标，通常应该是每次代码改动提交本身就既包括源代码的编写和改动，也包括相应单元测试脚本的编写和改动，并且这段单元测试脚本已经运行通过。

## 一、软件交付的目的

### 1.1 定义

软件交付，是一种系统全面的方法，对一个开发团队进行全方位、多层次的梳理，根据其所处的业务领域，当前采用的技术栈，当前使用的工具、流程和方法等实际情况，找出当前问题最突出、最值得改进的那些地方，甚至制定中长期的改进方案，一步一步扎扎实实地做。

### 1.2 软件交付的范围

软件交付过程，是指编写程序、改动代码之后的一系列活动，直到将软件发布到生产环境给用户，进入运维阶段为止。其中包括编写改动代码之后的开发人员自行测试、提交代码、集成（合并分支）、测试、调整、发布等。

软件交付过程包括三类事情：

其中最占精力的部分是各种各样的测试、反馈，以及相应的调整和修复，这是用来提高代码改动的质量的，会持续到可以将软件发布给所有使用者。这里所说的测试，既包括动态的测试如接口测试、UI测试，也包括静态的测试如代码审评和代码扫描，还包括各种人工测试及自动测试。

其次是一个代码库中分支之间的代码合并，以及不同代码库中最新版本之间的联合测试和发布。

最后是软件形态的转换，即将源代码经过编译构建，转换为安装包、容器镜像之类的形态，然后再经过部署过程，转换为实际运行中的软件系统。

### 1.3 一切为了业务成功：创造更多的价值

可以把软件开发全生命周期的所有相关活动大致分为两部分，一部分是定义软件应该长成什么样子，也就是定义侧；另一部分是实现它，也就是实现侧。

#### 1.3.1 软件 定义侧的目标：小步快跑

软件定义侧，定义软件应该长成什么样子。大体上，从CEO到产品经理、PO产品负责人、BA业务分析师等角色都在做相关的工作；制定镇古鳄的战略方向，抓住市场机会，最后落实到做好具体的软件产品设计上，也就是确定软件需求。

**软件开发的一个发展经验是：应该以比较小的代价多尝试、多探索，然后根据市场反馈采取进一步的行动——是放弃这个方向，还是调整这个方向，抑或是进一步投入、建设、完善。**

这样做的原因，是因为需求的不确定性。你无法保证做出来的软件是否可行，所以先做一个MVP（minimum viable product，最小可行性产品）试试看。在不同方向多试试说不定就找着了。

软件定义侧先只定义好一小步，然后软件实现侧赶快把这个试验品做出来，交给用户试用，如果可行就继续往下走，这样试错的成本越低，效率越高，产品成功的概率越大。

这样做的原因也是因为市场的变化太快，比如竞争对手上线了一个功能很受欢迎，那我们就要赶紧仿制一个，这样市场分额才不会都被对方吃掉。

再从另一个角度看小步快跑。假定需求都调查清楚了，我们是先把所有功能都做完然后一次全部上线呢，还是灰度发布，逐次发布更新先做出来就先发布给用户体验呢，建议应该尽量选择后者，每个子功能上线都能给用户带来一定的好处，这样也有利于抓住用户，哪怕当时和还不能享受所有的好处。

**所以，从定义侧和实现侧协作的角度来看，定义侧应该不断地定义小的需求，交给实现侧，然后实现侧尽快实现和交付这些小的需求。这就是小步快跑。**

**当然以上这些都是从软件需求方利益来考虑的，需求方的需求不确定所以需要不断试错，同时软件尽快开发出来占有市场，如果软件实现侧是第三方的，但从软件服务提供方的利益考虑，这种需求不确定不停的变换的要求是要极力避免的，因为这样会导致软件开发周期变长，项目不可控，开发成本增加，所以这种需求的不确定性应该在需求确定时就应该完全解决掉，或者试验性产品的开发单独算一个开发任务（不投入太多开发成本），等需求完全确定了再进入正式的开发阶段，这样开发阶段就不会因为需求的变更而不停返工了。**

#### 1.3.2 软件实现侧的目标

- 多，更高的产能——产出越多越好，没有上限。
- 快，更快的响应速度——软件定义侧给过来要尽快实现交付，越快越好没有上限。
- 好，适当的质量——质量越好是有代价的，代价包括产能变低、响应速度变慢、成本变高等，所以不是质量越高越好，而是先保证最低质量要求，再在综合情况下权衡调整，达到怎样的质量最“好”。
- 省，合理的成本，需要控制成本，如果有改进方案，能在不影响产能、响应速度、质量的情况下，把某个方面的成本明显降一降，那挺好（质量亦是如此）。但成本也不是越低越好，因为产品开发的目的不是省钱，而是创造更多的价值。

这可以对应项目管理三角形：“多、快、省”对应三角形的范围、时间、成本这三条边，而“好”则对应三角形中间经常写着的“质量”两个字。

总而言之，更高的产能和更快的响应速度时我们要追求的核心目标，而质量要达到特定业务的要求，同时适当考虑成本。

#### 1.3.3 软件交付过程追求的目标

**==追求的目标是更高的产能，==**也就是单位时间内能生产多少新特性，交付过程对它有一定影响，但影响更大的是响应速度。在项目开发中，首要影响因素是产能，谁的产能低，谁就决定了从改动代码到软件发布上线全过程的产嗯那个。而如果产能相当或产能足够高了，软件交付就容易成为影响产能的瓶颈了，这时会出现一种情况：越来越多已开发好的功能积压在一起，等待集成测试和发布。这样的交付效率无疑是失败的。**为此需要改进流程和工具以提高效率，**也可能需要调整人力资源在代码编写和交付过程中的分配。

讨论产能还有一个因素：**==资源聚焦==。**在项目团队总人数不变的情况下，**==如果通过改进流程和工具，提高了每个人在交付过程中的工作效率，减少了在交付过程中人力资源的投入，就可以把更多的人力资源分配到代码编写中，于是让整体产能更高。==**比如让开发人员首先自测通过后再交给测试人员测试，就能明显较少开发人员和测试人员之间的沟通交互，降低沟通成本，同时可以尽早发现问题，很快定位和修复，提高效率。于是，开发人员占比就可以更高，开发人员投入到代码编写活动中的时间也可以更多。

**更快的响应速度：对用户有意义的一小块完整的代码改动，也就是一个特性，从开始开发算起，其中在写代码之外还需要耗费的时间（构建、部署、测试、代码评审、上线审批和上线时间窗口等），反映在关键路径上要尽量短（效率高），将主要的资源和时间都用在开发上。这是我们要追求的目标。**

**适当的质量，在软件交付过程中不能因为一味的追求质量而无限延长测试时间，**而是要通过软件交付过程达到一定的质量要求。但究竟质量要求有多高，这是由特定业务决定的。

合理的成本——同理，这一条也适用。比如，对于持续集成服务器等硬件，配置好一些有利于提高软件交付的速度，但这也肯定不是无上限的。

尽管软件交付过程要追求的一般目标也是“多快好省”，但对它们的关注程度是不同的。**==追求目标的关键是要快，是在保证质量的前提下追求更快的交付，快点儿达到业务所需要的质量，让一个特性开发完很快就能上线。==**

